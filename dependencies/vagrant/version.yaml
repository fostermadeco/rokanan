---
version: 2.1.2
operator: '<='
description: |
  Vagrant 2.1.2 or lower is required to maintain compatibility with older projects
  (See https://github.com/hashicorp/vagrant/issues/10161)
binary: vagrant
check: |
  vagrant --version | cut -d' ' -f2
install: |
  HOMEBREW_NO_AUTO_UPDATE=1 brew cask install https://raw.githubusercontent.com/Homebrew/homebrew-cask/eeb3bf562ebfdc8960f3d2db0b6aa2ad747aaf75/Casks/vagrant.rb

additional_tests:
  - description: Checking that the vagrant-hostsupdater plugin is installed
    command: |
      [ ! -z `vagrant plugin list --machine-readable | awk -F, '/plugin-name/ && /vagrant-hostsupdater/ { print $NF }'` ]
    message: |
      The vagrant-hostsupdater plugin is required to automatically add entries to `/etc/hosts`.
    correction: |
      vagrant plugin install vagrant-hostsupdater
    success: >
      The vagrant-hostsupdater plugin was successfully installed.

  - description: Checking that the vagrant-triggers plugin is installed
    command: |
      [ ! -z `vagrant plugin list --machine-readable | awk -F, '/plugin-name/ && /vagrant-triggers/ { print $NF }'` ]
    message: |
      The vagrant-hostsupdater plugin is required to hook into the Vagrant action cycle.
    correction: |
      vagrant plugin install vagrant-triggers
    success: >
      The vagrant-triggers plugin was successfully installed

  - description: Checking that the vagrant-disksize plugin is installed
    command: |
      [ ! -z `vagrant plugin list --machine-readable | awk -F, '/plugin-name/ && /vagrant-disksize/ { print $NF }'` ]
    message: |
        The vagrant-disksize plugin is required to resizes new VMs to a usable size.
    correction: |
        vagrant plugin install vagrant-disksize
    success: >
      The vagrant-disksize plugin was successfully installed.
